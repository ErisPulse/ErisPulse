on:
  push:
    branches: [ develop ]

jobs:
  notify-develop:
    runs-on: ubuntu-latest
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: è·å–æäº¤ä¿¡æ¯
        id: commit_info
        run: |
          commit_msg=$(git log -1 --pretty=%B)
          echo "commit_msg=$commit_msg" >> $GITHUB_OUTPUT

      - name: è¯»å–æ”¶ä»¶äººåˆ—è¡¨
        id: get_emails
        run: |
          emails=$(cat .github/config/notify.json | jq -c '.emails[].address')
          echo "emails=$emails" >> $GITHUB_OUTPUT

      - name: å‘é€é‚®ä»¶é€šçŸ¥
        uses: ./.github/workflows/send-email
        with:
          subject: "[è‰¾è‰ä¸å¿«æŠ¥] develop åˆ†æ”¯æœ‰æ–°æäº¤å•¦~ ğŸŒ±"
          content: |
            ğŸ€ æ‚¨å¥½ä¸»äºº~

            æˆ‘æ˜¯è‰¾è‰ä¸ï¼Œè´Ÿè´£ä¸ºæ‚¨æ’­æŠ¥æœ€æ–°æ¶ˆæ¯ï¼
            develop åˆ†æ”¯åˆšåˆšæ”¶åˆ°äº†æ–°çš„æäº¤ï¼Œè¯·æ³¨æ„æŸ¥çœ‹ï¼

            ğŸ‘¤ æäº¤è€…ï¼š${{ github.event.pusher.name }}
            ğŸ“ æäº¤ä¿¡æ¯ï¼š${{ steps.commit_info.outputs.commit_msg }}

            ğŸ”— å˜æ›´åœ°å€ï¼š
            https://github.com/${{ github.repository }}/compare/${{ github.event.before }}...${{ github.event.after }}?expand=1

            ç¥æ‚¨æ¯å¤©éƒ½æœ‰å¥½å¿ƒæƒ…~ ğŸ’–
            â€”â€” è‰¾è‰ä¸
          recipients: ${{ steps.get_emails.outputs.emails }}
          resend_api_key: ${{ secrets.RESEND_API_KEY }}